{"version":3,"sources":["selectors/chat-selectors.ts","components/forms/AddMessageForm/AddMessageForm.tsx","components/CommonChat/Messages/Message/Message.tsx","components/CommonChat/Messages/Messages.tsx","components/CommonChat/CommonChat.tsx","pages/CommonChatPage/CommonChatPage.tsx"],"names":["chat","state","selectChatStatus","createSelector","status","selectChatMessages","messages","AddMessageForm","useState","message","setMessage","dispatch","useDispatch","useSelector","style","padding","autoSize","width","height","onChange","e","currentTarget","value","disabled","onClick","sendMessage","SendOutlined","Message","React","memo","console","log","borderBottom","alt","src","photo","userPhoto","borderRadius","paddingLeft","userName","Messages","messagesAnchorRef","useRef","isAutoScroll","setIsAutoScroll","useEffect","current","scrollIntoView","behavior","overflowY","onScroll","element","Math","abs","scrollHeight","scrollTop","clientHeight","map","m","key","id","ref","CommonChat","startMessagesListening","stopMessagesListening","CommonChatPage","WechatOutlined"],"mappings":"kQAGMA,EAAO,SAACC,GAAD,OAAyBA,EAAMD,MAE/BE,EAAmBC,YAC5B,CAACH,IACD,SAAAA,GAAI,OAAIA,EAAKI,UAGJC,EAAqBF,YAC9B,CAACH,IACD,SAAAA,GAAI,OAAIA,EAAKM,YCyBFC,EA7BgB,SAAC,GAAQ,qBACNC,mBAAS,IADJ,mBAC5BC,EAD4B,KACnBC,EADmB,KAE7BC,EAAWC,cAEXR,EAASS,YAAYX,GAU3B,OACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAKY,MAAO,CAACC,QAAS,eAClB,kBAAC,IAAD,CAAUC,UAAU,EAAMF,MAAO,CAACG,MAAO,IAAKC,OAAQ,IAAKC,SAAU,SAACC,GAAD,OAAOV,EAAWU,EAAEC,cAAcC,QAC7FA,MAAOb,KAIrB,kBAAC,IAAD,CAAKK,MAAO,CAACC,QAAS,eAClB,kBAAC,IAAD,CAAQQ,SAAqB,UAAXnB,EAAoBoB,QAjBvB,WAClBf,IAGLE,EAASc,YAAYhB,IACrBC,EAAW,OAYgE,kBAACgB,EAAA,EAAD,U,kBCXpEC,EAhBsCC,IAAMC,MAAK,YAAgB,IAAdpB,EAAa,EAAbA,QAE9D,OADAqB,QAAQC,IAAI,WAER,6BAEI,yBAAKjB,MAAO,CAACC,QAAS,eAAgBiB,aAAc,sBAChD,yBAAKC,IAAI,aAAaC,IAAuB,OAAlBzB,EAAQ0B,MAAiB1B,EAAQ0B,MAAQC,IAAWtB,MAAO,CAACG,MAAO,OAAQoB,aAAc,MACpH,uBAAGvB,MAAO,CAACG,MAAO,OAAQqB,YAAa,IAAK7B,EAAQ8B,UACpD,6BACC9B,EAAQA,aCsBV+B,EA9BM,WACjB,IAAMlC,EAAWO,YAAYR,GACvBoC,EAAoBC,iBAAuB,MAF1B,EAGiBlC,oBAAS,GAH1B,mBAGhBmC,EAHgB,KAGFC,EAHE,KAoBvB,OANAC,qBAAU,WACa,IAAD,EAAdF,IACA,UAAAF,EAAkBK,eAAlB,SAA2BC,eAAe,CAACC,SAAU,cAE1D,CAAC1C,IAGA,yBAAKQ,MAAO,CAACI,OAAQ,QAASD,MAAO,QAASgC,UAAW,QAASC,SAhBhD,SAAC9B,GACnB,IAAM+B,EAAU/B,EAAEC,cACd+B,KAAKC,IAAKF,EAAQG,aAAeH,EAAQI,UAAaJ,EAAQK,cAAgB,KAC7Eb,GAAgBC,GAAgB,GAEjCD,GAAgBC,GAAgB,KAY/BtC,EAASmD,KAAI,SAACC,GAAD,OAAO,kBAAC,EAAD,CAASC,IAAKD,EAAEE,GAAInD,QAASiD,OAClD,yBAAKG,IAAKpB,MCGPqB,EAxBQ,WAEnB,IAAMnD,EAAWC,cAEXR,EAASS,YAAYX,GAS3B,OAPA2C,qBAAU,WAEN,OADAlC,EAASoD,eACF,WACHpD,EAASqD,kBAEd,IAGC,6BACgB,UAAX5D,GAAsB,6EACvB,oCACI,kBAAC,EAAD,MACA,kBAAC,EAAD,SCTD6D,UAXQ,WACnB,OACI,6BACI,4BAAI,kBAACC,EAAA,EAAD,MAAJ,sDACA,kBAAC,IAAD,MACA,kBAAC,EAAD","file":"static/js/9.5730cb8d.chunk.js","sourcesContent":["import {AppStateType} from \"../redux/store/redux-store\";\r\nimport { createSelector } from 'reselect'\r\n\r\nconst chat = (state: AppStateType) => state.chat\r\n\r\nexport const selectChatStatus = createSelector(\r\n    [chat],\r\n    chat => chat.status\r\n)\r\n\r\nexport const selectChatMessages = createSelector(\r\n    [chat],\r\n    chat => chat.messages\r\n)","import React, {FC, useState} from \"react\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {sendMessage} from \"../../../redux/chat-reducer\";\r\nimport {Button, Col, Row} from \"antd\";\r\nimport TextArea from \"antd/lib/input/TextArea\";\r\nimport {SendOutlined} from \"@ant-design/icons\";\r\nimport {selectChatStatus} from \"../../../selectors/chat-selectors\";\r\n\r\nconst AddMessageForm: FC<{}> = ({}) => {\r\n    const [message, setMessage] = useState('')\r\n    const dispatch = useDispatch()\r\n\r\n    const status = useSelector(selectChatStatus)\r\n\r\n    const sendMessageHandler = () => {\r\n        if (!message) {\r\n            return;\r\n        }\r\n        dispatch(sendMessage(message))\r\n        setMessage('')\r\n    }\r\n\r\n    return (\r\n        <Row>\r\n            <Col style={{padding: '20px 0 0 0'}}>\r\n                <TextArea autoSize={true} style={{width: 420, height: 30}} onChange={(e) => setMessage(e.currentTarget.value)}\r\n                          value={message}>\r\n\r\n                </TextArea>\r\n            </Col>\r\n            <Col style={{padding: '20px 0 0 0'}}>\r\n                <Button disabled={status !== 'ready'} onClick={sendMessageHandler}><SendOutlined /></Button>\r\n            </Col>\r\n        </Row>\r\n    )\r\n}\r\n\r\nexport default AddMessageForm;","import React, {FC} from \"react\";\r\nimport {ChatMessageAPIType} from \"../../../../api/chat-api\";\r\nimport userPhoto from \"../../../../assets/images/user.png\";\r\n\r\nconst Message: FC<{ message: ChatMessageAPIType }> = React.memo(({message}) => {\r\n    console.log(\"message\")\r\n    return (\r\n        <div>\r\n\r\n            <div style={{padding: '3px 0 0 10px', borderBottom: '1px #dadcdf solid'}}>\r\n                <img alt='User photo' src={message.photo !== null ? message.photo : userPhoto} style={{width: '30px', borderRadius: 15}}/>\r\n                <b style={{width: '30px', paddingLeft: 7}}>{message.userName}</b>\r\n                <br/>\r\n                {message.message}\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n})\r\n\r\nexport default Message;","import React, {FC, useEffect, useRef, useState} from \"react\";\r\nimport {useSelector} from \"react-redux\";\r\nimport Message from \"./Message/Message\";\r\nimport {selectChatMessages} from \"../../../selectors/chat-selectors\";\r\n\r\nconst Messages: FC = () => {\r\n    const messages = useSelector(selectChatMessages)\r\n    const messagesAnchorRef = useRef<HTMLDivElement>(null)\r\n    const [isAutoScroll, setIsAutoScroll] = useState(false)\r\n\r\n    const scrollHandler = (e: React.UIEvent<HTMLDivElement, UIEvent>) => {\r\n        const element = e.currentTarget;\r\n        if (Math.abs((element.scrollHeight - element.scrollTop) - element.clientHeight) < 300) {\r\n            !isAutoScroll && setIsAutoScroll(true)\r\n        } else {\r\n            isAutoScroll && setIsAutoScroll(false)\r\n        }\r\n    }\r\n\r\n    useEffect(() => {\r\n        if (isAutoScroll) {\r\n            messagesAnchorRef.current?.scrollIntoView({behavior: 'smooth'})\r\n        }\r\n    }, [messages])\r\n\r\n    return (\r\n        <div style={{height: '400px', width: '500px', overflowY: 'auto'}} onScroll={scrollHandler}>\r\n            {messages.map((m) => <Message key={m.id} message={m}/>)}\r\n            <div ref={messagesAnchorRef}>\r\n\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Messages","import React, {FC, useEffect} from \"react\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {startMessagesListening, stopMessagesListening} from \"../../redux/chat-reducer\";\r\nimport AddMessageForm from \"../forms/AddMessageForm/AddMessageForm\";\r\nimport Messages from \"./Messages/Messages\";\r\nimport {selectChatStatus} from \"../../selectors/chat-selectors\";\r\n\r\nconst CommonChat: FC = () => {\r\n\r\n    const dispatch = useDispatch()\r\n\r\n    const status = useSelector(selectChatStatus)\r\n\r\n    useEffect(() => {\r\n        dispatch(startMessagesListening());\r\n        return () => {\r\n            dispatch(stopMessagesListening());\r\n        }\r\n    }, [])\r\n\r\n    return (\r\n        <div>\r\n            {status === 'error' && <div>Some error occurred. Please refresh the page</div>}\r\n            <>\r\n                <Messages/>\r\n                <AddMessageForm/>\r\n            </>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default CommonChat;\r\n","import React from 'react';\r\nimport {WechatOutlined} from \"@ant-design/icons\";\r\nimport {Divider} from \"antd\";\r\nimport CommonChat from \"../../components/CommonChat/CommonChat\";\r\n\r\nconst CommonChatPage = () => {\r\n    return (\r\n        <div>\r\n            <h2><WechatOutlined/> Общий чат</h2>\r\n            <Divider/>\r\n            <CommonChat/>\r\n        </div>\r\n    )\r\n}\r\n\r\n\r\nexport default CommonChatPage;"],"sourceRoot":""}