{"version":3,"sources":["utils/scroll-chat-helper.ts","components/forms/AddMessageForm/AddMessageForm.styled.ts","../node_modules/@ant-design/icons-svg/es/asn/CloseCircleOutlined.js","../node_modules/@ant-design/icons/es/icons/CloseCircleOutlined.js","selectors/dialogs-selectors.ts","components/Dialogs/Dialogs/Dialogs.styled.ts","components/Dialogs/Dialog/Dialog.styled.ts","components/Dialogs/Dialog/Dialog.tsx","components/Dialogs/Dialogs/Dialogs.tsx","components/Dialogs/DialogsChat/DialogsChat.styled.ts","components/Dialogs/DialogsChat/DialogMessage/DialogMessage.styled.ts","components/Dialogs/DialogsChat/DialogMessage/DialogMessage.tsx","components/forms/AddDialogMessageForm/AddDialogMessageForm.styled.ts","components/forms/AddDialogMessageForm/AddDialogMessageForm.tsx","components/Dialogs/DialogsChat/DialogsChat.tsx","pages/DialogsPage/DialogsPage.tsx"],"names":["scrollChatHelper","e","isAutoScroll","setIsAutoScroll","element","currentTarget","Math","abs","scrollHeight","scrollTop","clientHeight","autoScrollHelper","current","scrollIntoView","behavior","window","scrollTo","AddMessageFormElement","styled","Col","AddMessageFormTextArea","TextArea","CloseCircleOutlined","props","ref","React","AntdIcon","Object","assign","icon","CloseCircleOutlinedSvg","displayName","dialogsPage","state","selectDialogs","createSelector","dialogs","selectDialogMessages","messages","selectDialogUserId","selectedUserId","DialogsListCol","DialogsList","List","DialogDate","p","DialogItemInfo","DialogItem","Row","selecteddialog","hasnewmessage","DialogItemRight","Dialog","hasNewMessage","photo","userName","lastUserActivityDate","newMessagesCount","userId","dispatch","useDispatch","useState","selectedDialog","setSelectedDialog","formattedDate","substr","split","join","onClick","getDialogMessages","size","src","Dialogs","map","d","id","key","photos","small","DialogChatWindow","div","DialogMessagesBlock","NoDialogHeader","h1","DialogMessageElement","viewed","DialogMessageText","DeleteMessageButton","memo","messageText","senderId","messageId","selectedDialogUserData","useSelector","selectAuthorizedUserId","selectAuthorizedUserAvatar","avatar","findSenderUser","find","dialog","selectDialogUserData","alt","deleteDialogMessage","AddDialogMessageFormTextArea","AddDialogMessageForm","message","setMessage","placeholder","autoSize","onPressEnter","event","preventDefault","sendDialogMessage","onChange","value","DialogsChat","messagesAnchorRef","useRef","useEffect","refresh","setInterval","console","log","clearInterval","onScroll","length","m","body","withAuthRedirect","getDialogs","Preloader","MessageOutlined"],"mappings":"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","file":"static/js/7.5f781dbd.chunk.js","sourcesContent":["import React, {RefObject} from \"react\";\r\n\r\nexport const scrollChatHelper = (\r\n    e: React.UIEvent<HTMLDivElement, UIEvent>,\r\n    isAutoScroll: boolean,\r\n    setIsAutoScroll: (bool: boolean) => void) => {\r\n\r\n    const element = e.currentTarget;\r\n    if (Math.abs((element.scrollHeight - element.scrollTop) - element.clientHeight) < 300) {\r\n        !isAutoScroll && setIsAutoScroll(true)\r\n    } else {\r\n        isAutoScroll && setIsAutoScroll(false)\r\n    }\r\n}\r\n\r\nexport const autoScrollHelper = (e: RefObject<HTMLDivElement>, isAutoScroll: boolean) => {\r\n    const element = e.current;\r\n    element?.scrollIntoView({behavior: 'smooth'})\r\n    if (isAutoScroll) {\r\n        element?.scrollIntoView({behavior: 'smooth'})\r\n    }\r\n    window.scrollTo(0,0)\r\n}","import styled from \"styled-components\";\r\nimport {Col} from \"antd\";\r\nimport TextArea from \"antd/lib/input/TextArea\";\r\n\r\nexport const AddMessageFormElement = styled(Col)`\r\n  padding: 20px 0 0 0;\r\n`\r\n\r\nexport const AddMessageFormTextArea = styled(TextArea)`\r\n  width: 500px;\r\n  height: 30px;\r\n`","// This icon file is generated automatically.\nvar CloseCircleOutlined = { \"icon\": { \"tag\": \"svg\", \"attrs\": { \"viewBox\": \"64 64 896 896\", \"focusable\": \"false\" }, \"children\": [{ \"tag\": \"path\", \"attrs\": { \"d\": \"M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4-66.1-.3c-4.4 0-8 3.5-8 8 0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 00-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4 66 .3c4.4 0 8-3.5 8-8 0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z\" } }, { \"tag\": \"path\", \"attrs\": { \"d\": \"M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448 448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z\" } }] }, \"name\": \"close-circle\", \"theme\": \"outlined\" };\nexport default CloseCircleOutlined;\n","// GENERATE BY ./scripts/generate.ts\n// DON NOT EDIT IT MANUALLY\nimport * as React from 'react';\nimport CloseCircleOutlinedSvg from \"@ant-design/icons-svg/es/asn/CloseCircleOutlined\";\nimport AntdIcon from '../components/AntdIcon';\n\nvar CloseCircleOutlined = function CloseCircleOutlined(props, ref) {\n  return /*#__PURE__*/React.createElement(AntdIcon, Object.assign({}, props, {\n    ref: ref,\n    icon: CloseCircleOutlinedSvg\n  }));\n};\n\nCloseCircleOutlined.displayName = 'CloseCircleOutlined';\nexport default /*#__PURE__*/React.forwardRef(CloseCircleOutlined);","import {AppStateType} from \"../redux/store/redux-store\";\r\nimport { createSelector } from 'reselect'\r\nimport {selectAuthorizedUserAvatar, selectAuthorizedUserId} from \"./auth-selectors\";\r\n\r\nconst dialogsPage = (state: AppStateType) => state.dialogsPage\r\n\r\nexport const selectDialogs = createSelector(\r\n    [dialogsPage],\r\n    dialogsPage => dialogsPage.dialogs\r\n)\r\n\r\nexport const selectDialogMessages = createSelector(\r\n    [dialogsPage],\r\n    dialogsPage => dialogsPage.messages\r\n)\r\n\r\nexport const selectDialogUserId = createSelector(\r\n    [dialogsPage],\r\n    dialogsPage => dialogsPage.selectedUserId\r\n)\r\n\r\nexport const selectDialogUserData = (senderId: number) => createSelector(\r\n    [selectDialogs, selectAuthorizedUserId, selectAuthorizedUserAvatar],\r\n    (selectDialogs, userId, avatar) => {\r\n        const findSenderUser = selectDialogs.find((dialog) => dialog.id === senderId)\r\n        if (senderId === userId) return ['Вы', avatar]\r\n        return [findSenderUser?.userName, findSenderUser?.photos.small]\r\n    }\r\n)","import styled from \"styled-components\";\r\nimport {Col, List} from \"antd\";\r\n\r\nexport const DialogsListCol = styled(Col)`\r\n  padding-right: 20px;\r\n  border-right: 1px #ebedee solid;\r\n`\r\n\r\nexport const DialogsList = styled(List)`\r\n  width: 300px;\r\n`","import styled from \"styled-components\";\r\nimport {Col, Row} from \"antd\";\r\n\r\nexport const DialogDate = styled.p`\r\n  margin: 0;\r\n  padding: 0;\r\n  color: gray;\r\n  font-size: 13px;\r\n`\r\n\r\nexport const DialogItemInfo = styled(Col)`\r\n  padding-left: 20px;\r\n`\r\n\r\nexport const DialogItem = styled(Row)<{ hasnewmessage: boolean, selecteddialog: string}>`\r\n  background-color: ${props => (props.selecteddialog === \"1\" && \"#ebedee\")};\r\n  background-color: ${props => (props.hasnewmessage && \"#e6eff7\")};\r\n  width: 300px;\r\n  padding: 10px;\r\n  //transition: 0.2s;\r\n\r\n  //&:hover {\r\n  //  opacity: 1;\r\n  //  background-color: #ebedee;\r\n  //}\r\n\r\n  cursor: pointer;\r\n  border-bottom: 1px #eef0f0 solid;\r\n`\r\n\r\nexport const DialogItemRight = styled(Col)`\r\n  font-size: 16px;\r\n  margin-left: auto;\r\n  color: gray;\r\n`","import React, {FC, useState} from \"react\";\r\nimport {useDispatch} from \"react-redux\";\r\nimport {getDialogMessages} from \"../../../redux/dialogs-reducer\";\r\nimport {DialogDate, DialogItem, DialogItemInfo, DialogItemRight} from \"./Dialog.styled\";\r\nimport {Avatar, Col} from \"antd\";\r\nimport {CloseCircleOutlined} from \"@ant-design/icons\";\r\n\r\ntype PropsType = {\r\n    hasNewMessage: boolean\r\n    lastUserActivityDate: string\r\n    newMessagesCount: number\r\n    photo: string | null\r\n    userName: string\r\n    userId: number\r\n}\r\n\r\nconst Dialog: FC<PropsType> = ({\r\n                                   hasNewMessage,\r\n                                   photo,\r\n                                   userName,\r\n                                   lastUserActivityDate,\r\n                                   newMessagesCount,\r\n                                   userId\r\n                               }) => {\r\n    const dispatch = useDispatch();\r\n    const [selectedDialog, setSelectedDialog] = useState<\"1\" | \"0\">(\"0\")\r\n\r\n    const formattedDate = lastUserActivityDate\r\n            .substr(5, 5)\r\n            .split('-').join('.') + ' в '\r\n        + lastUserActivityDate.substr(11, 5);\r\n\r\n    const handleSelect = () => {\r\n        setSelectedDialog(\"1\")\r\n        dispatch(getDialogMessages(userId))\r\n    }\r\n\r\n    return (\r\n        <DialogItem\r\n            hasnewmessage={hasNewMessage}\r\n            selecteddialog={selectedDialog}\r\n            onClick={handleSelect}>\r\n            <Col>\r\n                <Avatar size={'large'} src={photo}/>\r\n            </Col>\r\n            <DialogItemInfo>\r\n                <span>{userName}</span>\r\n                <DialogDate>{formattedDate}</DialogDate>\r\n            </DialogItemInfo>\r\n            <DialogItemRight>\r\n                <span>{newMessagesCount !== 0 && newMessagesCount} </span>\r\n                <CloseCircleOutlined/>\r\n            </DialogItemRight>\r\n        </DialogItem>\r\n    );\r\n}\r\n\r\nexport default Dialog;","import React, {FC, useEffect, useState} from \"react\";\r\nimport {DialogType} from \"../../../types/types\";\r\nimport {DialogsList, DialogsListCol} from \"./Dialogs.styled\";\r\nimport Dialog from \"../Dialog/Dialog\";\r\n\r\nconst Dialogs: FC<{ dialogs: Array<DialogType> }> = ({dialogs}) => {\r\n    return (\r\n        <DialogsListCol>\r\n            <DialogsList>\r\n                {dialogs.map(d => <Dialog\r\n                    userId={d.id}\r\n                    key={d.id}\r\n                    userName={d.userName}\r\n                    lastUserActivityDate={d.lastUserActivityDate}\r\n                    newMessagesCount={d.newMessagesCount}\r\n                    photo={d.photos.small}\r\n                    hasNewMessage={d.hasNewMessage}\r\n                />)}\r\n            </DialogsList>\r\n        </DialogsListCol>\r\n    )\r\n}\r\n\r\nexport default Dialogs;","import styled from \"styled-components\";\r\nimport {Col} from \"antd\";\r\n\r\nexport const DialogChatWindow = styled.div`\r\n  overflow-y: auto;\r\n  height: 100%;\r\n  border: 1px #ebedee solid;\r\n  border-radius: 2px;\r\n  background-color: #f3f5f7;\r\n`\r\n\r\nexport const DialogMessagesBlock = styled(Col)`\r\n  padding-left: 20px;\r\n  max-height: 515px;\r\n  width: 450px;\r\n`\r\n\r\nexport const NoDialogHeader = styled.h1`\r\n  text-align: center;\r\n  padding-top: 50%;\r\n  color: gray;\r\n`","import styled from \"styled-components\";\r\nimport {CloseCircleOutlined} from \"@ant-design/icons\";\r\n\r\nexport const DialogMessageElement = styled.div<{ viewed: boolean }>`\r\n  background-color: ${props => (!props.viewed && \"#e6eff7\")};\r\n  border-bottom: 1px #dadcdf solid;\r\n  padding: 13px 0 5px 10px;\r\n`\r\n\r\nexport const DialogMessageText = styled.p`\r\n  padding: 0 0 0 5px;\r\n  margin: 0;\r\n  word-wrap: break-word\r\n`\r\n\r\nexport const DeleteMessageButton = styled(CloseCircleOutlined)`\r\n  color: gray;\r\n  font-size: 18px;\r\n  float: right;\r\n  padding-right: 10px;\r\n`","import React, {FC} from \"react\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {Avatar} from \"antd\";\r\nimport {DeleteMessageButton, DialogMessageElement, DialogMessageText} from \"./DialogMessage.styled\";\r\nimport {selectDialogUserData} from \"../../../../selectors/dialogs-selectors\";\r\nimport {deleteDialogMessage} from \"../../../../redux/dialogs-reducer\";\r\n\r\ntype DialogMessagePropsType = {\r\n    messageText: string\r\n    senderId: number\r\n    viewed: boolean\r\n    messageId: string\r\n}\r\n\r\nconst DialogMessage: FC<DialogMessagePropsType> = ({messageText, senderId,viewed, messageId}) => {\r\n    const selectedDialogUserData = useSelector(selectDialogUserData(senderId))\r\n    const dispatch = useDispatch()\r\n\r\n    const handleDeleteMessage = () => {\r\n        dispatch(deleteDialogMessage(messageId))\r\n    }\r\n\r\n    return (\r\n        <DialogMessageElement viewed={viewed}>\r\n            <Avatar size={'large'} src={selectedDialogUserData[1]} alt=\"Dialog message\"/>&nbsp;\r\n             <b>{selectedDialogUserData[0]}</b> <DeleteMessageButton onClick={handleDeleteMessage}/>\r\n            <DialogMessageText>{messageText}</DialogMessageText>\r\n        </DialogMessageElement>\r\n    );\r\n}\r\n\r\nexport default React.memo(DialogMessage);","import styled from \"styled-components\";\r\nimport TextArea from \"antd/lib/input/TextArea\";\r\n\r\nexport const AddDialogMessageFormTextArea = styled(TextArea)`\r\n  height: 30px;\r\n  width: 450px;\r\n`","import {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectDialogUserId} from \"../../../selectors/dialogs-selectors\";\r\nimport React, {useState} from \"react\";\r\nimport {sendDialogMessage} from \"../../../redux/dialogs-reducer\";\r\nimport {Row} from \"antd\";\r\nimport {AddMessageFormElement} from \"../AddMessageForm/AddMessageForm.styled\";\r\nimport {AddDialogMessageFormTextArea} from \"./AddDialogMessageForm.styled\";\r\n\r\nconst AddDialogMessageForm = () => {\r\n    const selectedUserId = useSelector(selectDialogUserId)\r\n\r\n    const [message, setMessage] = useState<string>('')\r\n    const dispatch = useDispatch()\r\n\r\n    const sendMessageHandler = (event: React.KeyboardEvent) => {\r\n        if (event.key === 'Enter'){\r\n            event.preventDefault();\r\n        }\r\n        if (!message) {\r\n            return;\r\n        }\r\n        dispatch(sendDialogMessage(selectedUserId, message))\r\n        setMessage('')\r\n    }\r\n\r\n    return (\r\n        <form>\r\n            <Row>\r\n                <AddMessageFormElement>\r\n                    <AddDialogMessageFormTextArea\r\n                        placeholder=\"Напишите сообщение...\"\r\n                        autoSize\r\n                        onPressEnter={sendMessageHandler}\r\n                        onChange={(e) => setMessage(e.currentTarget.value)}\r\n                        value={message}>\r\n                    </AddDialogMessageFormTextArea>\r\n                </AddMessageFormElement>\r\n                {/*<AddMessageFormElement>*/}\r\n                {/*    <Button onKeyDown={sendMessageHandler}>*/}\r\n                {/*        <SendOutlined/>*/}\r\n                {/*    </Button>*/}\r\n                {/*</AddMessageFormElement>*/}\r\n            </Row>\r\n        </form>\r\n    );\r\n}\r\n\r\nexport default AddDialogMessageForm;","import {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectDialogMessages, selectDialogUserId} from \"../../../selectors/dialogs-selectors\";\r\nimport {DialogChatWindow, DialogMessagesBlock, NoDialogHeader} from \"./DialogsChat.styled\";\r\nimport React, {useEffect, useRef, useState} from \"react\";\r\nimport DialogMessage from \"./DialogMessage/DialogMessage\";\r\nimport AddDialogMessageForm from \"../../forms/AddDialogMessageForm/AddDialogMessageForm\";\r\nimport {autoScrollHelper, scrollChatHelper} from \"../../../utils/scroll-chat-helper\";\r\nimport {getDialogMessages} from \"../../../redux/dialogs-reducer\";\r\n\r\nconst DialogsChat = () => {\r\n    const messages = useSelector(selectDialogMessages)\r\n    const [isAutoScroll, setIsAutoScroll] = useState<boolean>(false)\r\n    const messagesAnchorRef = useRef<HTMLDivElement>(null)\r\n    const selectedUserId = useSelector(selectDialogUserId)\r\n    const dispatch = useDispatch()\r\n\r\n    useEffect(() => {\r\n        autoScrollHelper(messagesAnchorRef, isAutoScroll)\r\n    }, [messages])\r\n\r\n    useEffect(() => {\r\n        let refresh = null as any\r\n        if (selectedUserId !== 0) {\r\n            refresh = setInterval(() =>  {console.log(selectedUserId, messages); dispatch(getDialogMessages(selectedUserId))}, 3000)\r\n        }\r\n        if (refresh !== null) return () => clearInterval(refresh)\r\n    }, [messages, selectedUserId]);\r\n\r\n    const scrollHandler = (e: React.UIEvent<HTMLDivElement, UIEvent>) => {\r\n        scrollChatHelper(e, isAutoScroll, setIsAutoScroll)\r\n    }\r\n\r\n    return (\r\n        <>\r\n            <DialogMessagesBlock>\r\n                {!!selectedUserId ?\r\n                    <>\r\n                        <DialogChatWindow onScroll={scrollHandler}>\r\n                            {messages.length !== 0 ?\r\n                                messages.map(m => <DialogMessage\r\n                                    key={m.id}\r\n                                    messageId={m.id}\r\n                                    messageText={m.body}\r\n                                    senderId={m.senderId}\r\n                                    viewed={m.viewed}\r\n                                />) : <NoDialogHeader>Нет сообщений</NoDialogHeader>\r\n                            }\r\n                            <div ref={messagesAnchorRef}>\r\n\r\n                            </div>\r\n                        </DialogChatWindow>\r\n                        <AddDialogMessageForm/>\r\n                    </>\r\n                    : <NoDialogHeader>\r\n                        Выберите диалог\r\n                    </NoDialogHeader>\r\n                }\r\n            </DialogMessagesBlock>\r\n        </>\r\n    );\r\n}\r\n\r\nexport default DialogsChat;","import {Row} from \"antd\"\r\nimport React, {FC, useEffect} from \"react\"\r\nimport {MessageOutlined} from \"@ant-design/icons\";\r\nimport {withAuthRedirect} from \"../../hoc/withAuthRedirect\";\r\nimport {useDispatch, useSelector} from \"react-redux\";\r\nimport {selectDialogs} from \"../../selectors/dialogs-selectors\";\r\nimport {getDialogs} from \"../../redux/dialogs-reducer\";\r\nimport Dialogs from \"../../components/Dialogs/Dialogs/Dialogs\";\r\nimport DialogsChat from \"../../components/Dialogs/DialogsChat/DialogsChat\";\r\nimport Preloader from \"../../components/common/Preloader/Preloader\";\r\n\r\nconst DialogsPage: FC = () => {\r\n    const dialogs = useSelector(selectDialogs);\r\n    const dispatch = useDispatch()\r\n\r\n    useEffect(() => {\r\n        dispatch(getDialogs())\r\n    }, [dispatch]);\r\n\r\n    if (dialogs.length === 0) {\r\n        return <Preloader/>\r\n    }\r\n\r\n    return (\r\n        <div>\r\n            <h2><MessageOutlined/> Мессенджер</h2>\r\n            <Row>\r\n                <Dialogs dialogs={dialogs}/>\r\n                <DialogsChat/>\r\n            </Row>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default withAuthRedirect(DialogsPage);"],"sourceRoot":""}